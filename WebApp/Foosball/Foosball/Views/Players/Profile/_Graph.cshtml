@{
    var dataSource = new List<object>();
    foreach (var rating in ViewBag.Ratings)
    {
        dataSource.Add(new 
        {
            Rating = rating.ELO,
            Timestamp = rating.CreatedAt.ToString("yyyy-MM-dd")
        });
    }
}

@(Html.DevExtreme().Chart()
    .ID("line-chart")
    .Palette(VizPalette.Violet)
    .CommonSeriesSettings(s => s
        .ArgumentField("Timestamp")
        .ValueField("Rating")
        .Type(SeriesType.Line)
    )
    .Margin(m => m.Bottom(20).Right(20))
    .ArgumentAxis(a => a
        .ValueMarginsEnabled(false)
        .DiscreteAxisDivisionMode(DiscreteAxisDivisionMode.CrossLabels)
        .Grid(g => g.Visible(true))
        .ArgumentType(ChartDataType.DateTime)

    )
    .Series(s =>
    {
        s.Add().ValueField("Rating").Name("Rating");
    })
    .Legend(l => l.Visible(false))
    .Title(t => t
        .Text("Player's History")
        .Subtitle(s => s.Text("(ELO rating)"))
    )
    .Export(e => e.Enabled(true))
    .Tooltip(t => t
        .Enabled(true)
        .CustomizeTooltip(@<text>
    function (arg) {
        return {
            text: arg.valueText
        };
    }
    </text>)
    )
    .DataSource(dataSource)
)
